<!DOCTYPE html>
<html lang="en">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-G14Q10H6Y2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-G14Q10H6Y2');
</script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ðŸ§ª Member Portal Interactive Test</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 1000px; margin: 0 auto; padding: 20px; }
    .test-section { margin: 20px 0; padding: 20px; border: 2px solid #e9ecef; border-radius: 8px; }
    .success { border-color: #28a745; background: #f8fff9; }
    .error { border-color: #dc3545; background: #fff8f8; }
    .info { border-color: #17a2b8; background: #f8fdff; }
    button { margin: 5px; padding: 8px 16px; border: 1px solid #ccc; border-radius: 4px; cursor: pointer; }
    button:hover { background: #f8f9fa; }
    .btn-primary { background: #007bff; color: white; border-color: #007bff; }
    .btn-success { background: #28a745; color: white; border-color: #28a745; }
    .btn-danger { background: #dc3545; color: white; border-color: #dc3545; }
    .test-results { margin: 10px 0; padding: 10px; background: #f8f9fa; border-radius: 4px; font-family: monospace; }
    .demo-account { background: #fff3cd; padding: 8px 12px; border-radius: 4px; margin: 5px 0; font-family: monospace; }
    .current-user { background: #d4edda; padding: 10px; border-radius: 4px; margin: 10px 0; }
  </style>
</head>
<body>
  <h1>ðŸ§ª Member Portal System - Interactive Test Suite</h1>
  <p><strong>Test Date:</strong> September 29, 2025</p>

  <!-- System Status -->
  <div id="system-status" class="test-section info">
    <h3>ðŸ“Š System Status</h3>
    <p>Checking Member Portal system initialization...</p>
    <div id="status-results" class="test-results"></div>
  </div>

  <!-- Demo Accounts -->
  <div class="test-section">
    <h3>ðŸ”‘ Demo Accounts Available</h3>
    <div class="demo-account">
      <strong>Regular Member:</strong> member@cvawvuaa.org / member123
    </div>
    <div class="demo-account">
      <strong>Premium Member:</strong> premium@cvawvuaa.org / premium123  
    </div>
    <div class="demo-account">
      <strong>Board Member:</strong> board@cvawvuaa.org / board123
    </div>
  </div>

  <!-- Current User Status -->
  <div id="user-status" class="test-section">
    <h3>ðŸ‘¤ Current User Status</h3>
    <div id="current-user-info">Not logged in</div>
    <button onclick="refreshUserStatus()">ðŸ”„ Refresh Status</button>
  </div>

  <!-- Test 1: Basic Authentication -->
  <div id="test1" class="test-section">
    <h3>ðŸ” Test 1: Authentication System</h3>
    <p>Test login functionality with different account types:</p>
    
    <div style="margin: 10px 0;">
      <button class="btn-primary" onclick="testLogin('member@cvawvuaa.org', 'member123')">Test Regular Login</button>
      <button class="btn-primary" onclick="testLogin('premium@cvawvuaa.org', 'premium123')">Test Premium Login</button>
      <button class="btn-primary" onclick="testLogin('board@cvawvuaa.org', 'board123')">Test Board Login</button>
      <button onclick="testLogout()">Logout</button>
    </div>
    
    <div id="auth-results" class="test-results"></div>
  </div>

  <!-- Test 2: Membership Benefits -->
  <div id="test2" class="test-section">
    <h3>ðŸ’Ž Test 2: Membership Benefits System</h3>
    <p>Test benefit access for different membership levels:</p>
    
    <button onclick="testBenefits()">ðŸ§ª Test All Benefits</button>
    <button onclick="testMemberDirectory()">ðŸ‘¥ Test Directory Access</button>
    <button onclick="testExclusiveContent()">ðŸ’Ž Test Exclusive Content</button>
    
    <div id="benefits-results" class="test-results"></div>
  </div>

  <!-- Test 3: Admin Functions -->
  <div id="test3" class="test-section">
    <h3>ðŸ”§ Test 3: Administrative Functions</h3>
    <p>Test board member administrative capabilities:</p>
    
    <button onclick="testMemberStats()">ðŸ“Š Test Member Statistics</button>
    <button onclick="testMemberManagement()">ðŸ‘¥ Test Member Management</button>
    <button onclick="testRegistrationFlow()">ðŸ“ Test Registration</button>
    
    <div id="admin-results" class="test-results"></div>
  </div>

  <!-- Test 4: Data Persistence -->
  <div id="test4" class="test-section">
    <h3>ðŸ’¾ Test 4: Data Persistence</h3>
    <p>Test data storage and session management:</p>
    
    <button onclick="testDataStorage()">ðŸ’¾ Test LocalStorage</button>
    <button onclick="testSessionPersistence()">ðŸ”„ Test Session Persistence</button>
    <button onclick="clearAllData()">ðŸ—‘ï¸ Clear All Data</button>
    
    <div id="storage-results" class="test-results"></div>
  </div>

  <!-- Test 5: Integration Testing -->
  <div id="test5" class="test-section">
    <h3>ðŸ”— Test 5: System Integration</h3>
    <p>Test integration with existing systems:</p>
    
    <button onclick="testRSVPIntegration()">ðŸŽ« Test RSVP Integration</button>
    <button onclick="testNewsletterIntegration()">ðŸ“§ Test Newsletter Integration</button>
    <button onclick="testNotifications()">ðŸ”” Test Notifications</button>
    
    <div id="integration-results" class="test-results"></div>
  </div>

  <!-- Overall Results -->
  <div id="overall-results" class="test-section">
    <h3>ðŸŽ¯ Overall Test Results</h3>
    <button onclick="runAllTests()" class="btn-success">ðŸš€ Run All Tests</button>
    <button onclick="generateReport()" class="btn-primary">ðŸ“Š Generate Report</button>
    
    <div id="final-results" class="test-results"></div>
  </div>

  <script src="js/member-portal.js"></script>
  <script>
    // Global test variables
    let testResults = {};
    let memberPortal;

    // Initialize system
    function initializeSystem() {
      try {
        if (typeof MemberPortal === 'undefined') {
          document.getElementById('status-results').innerHTML = 'âŒ MemberPortal class not loaded';
          return false;
        }

        memberPortal = new MemberPortal();
        document.getElementById('status-results').innerHTML = 'âœ… Member Portal system initialized successfully';
        document.getElementById('system-status').className = 'test-section success';
        return true;
      } catch (error) {
        document.getElementById('status-results').innerHTML = 'âŒ System initialization failed: ' + error.message;
        document.getElementById('system-status').className = 'test-section error';
        return false;
      }
    }

    // Refresh user status display
    function refreshUserStatus() {
      if (!memberPortal) return;

      const userInfo = document.getElementById('current-user-info');
      if (memberPortal.isLoggedIn()) {
        const user = memberPortal.currentUser;
        userInfo.innerHTML = `
          <div class="current-user">
            <strong>âœ… Logged in as:</strong> ${user.name} (${user.email})<br>
            <strong>Membership Type:</strong> ${user.memberType}<br>
            <strong>Member Since:</strong> ${user.joinDate}<br>
            <strong>Status:</strong> ${user.status}
          </div>
        `;
      } else {
        userInfo.innerHTML = '<div style="color: #6c757d;">âŒ Not logged in</div>';
      }
    }

    // Test authentication
    function testLogin(email, password) {
      if (!memberPortal) return;

      try {
        const success = memberPortal.login(email, password);
        const results = document.getElementById('auth-results');
        
        if (success) {
          results.innerHTML += `âœ… Login successful for ${email} (${memberPortal.currentUser.memberType})<br>`;
          refreshUserStatus();
          testResults.auth = true;
        } else {
          results.innerHTML += `âŒ Login failed for ${email}<br>`;
          testResults.auth = false;
        }
      } catch (error) {
        document.getElementById('auth-results').innerHTML += `âŒ Login error: ${error.message}<br>`;
        testResults.auth = false;
      }
    }

    function testLogout() {
      if (!memberPortal) return;

      try {
        memberPortal.logout();
        document.getElementById('auth-results').innerHTML += 'âœ… Logout successful<br>';
        refreshUserStatus();
      } catch (error) {
        document.getElementById('auth-results').innerHTML += `âŒ Logout error: ${error.message}<br>`;
      }
    }

    // Test benefits system
    function testBenefits() {
      if (!memberPortal || !memberPortal.isLoggedIn()) {
        document.getElementById('benefits-results').innerHTML = 'âŒ Please log in first to test benefits<br>';
        return;
      }

      const results = document.getElementById('benefits-results');
      const user = memberPortal.currentUser;
      
      results.innerHTML += `ðŸ§ª Testing benefits for ${user.memberType} member:<br>`;
      
      // Test basic benefits
      const hasEvents = memberPortal.hasBenefit('events');
      const hasNewsletter = memberPortal.hasBenefit('newsletter');
      const hasDirectory = memberPortal.hasBenefit('directory');
      const hasExclusive = memberPortal.hasBenefit('exclusive');
      const hasAdmin = memberPortal.hasBenefit('admin');

      results.innerHTML += `- Events: ${hasEvents ? 'âœ…' : 'âŒ'}<br>`;
      results.innerHTML += `- Newsletter: ${hasNewsletter ? 'âœ…' : 'âŒ'}<br>`;
      results.innerHTML += `- Directory: ${hasDirectory ? 'âœ…' : 'âŒ'}<br>`;
      results.innerHTML += `- Exclusive: ${hasExclusive ? 'âœ…' : 'âŒ'}<br>`;
      results.innerHTML += `- Admin: ${hasAdmin ? 'âœ…' : 'âŒ'}<br>`;

      testResults.benefits = true;
    }

    function testMemberDirectory() {
      if (!memberPortal || !memberPortal.isLoggedIn()) {
        document.getElementById('benefits-results').innerHTML += 'âŒ Login required for directory access<br>';
        return;
      }

      if (memberPortal.hasBenefit('directory')) {
        document.getElementById('benefits-results').innerHTML += 'âœ… Member directory access granted<br>';
        // Simulate showing directory
        memberPortal.showMemberDirectory();
      } else {
        document.getElementById('benefits-results').innerHTML += 'âŒ Member directory access denied (upgrade required)<br>';
      }
    }

    function testExclusiveContent() {
      if (!memberPortal || !memberPortal.isLoggedIn()) {
        document.getElementById('benefits-results').innerHTML += 'âŒ Login required for exclusive content<br>';
        return;
      }

      if (memberPortal.hasBenefit('exclusive')) {
        document.getElementById('benefits-results').innerHTML += 'âœ… Exclusive content access granted<br>';
      } else {
        document.getElementById('benefits-results').innerHTML += 'âŒ Exclusive content access denied (premium required)<br>';
      }
    }

    // Test admin functions
    function testMemberStats() {
      if (!memberPortal) return;

      try {
        const stats = memberPortal.getMemberStats();
        const results = document.getElementById('admin-results');
        results.innerHTML += `ðŸ“Š Member Statistics:<br>`;
        results.innerHTML += `- Total: ${stats.total}<br>`;
        results.innerHTML += `- Active: ${stats.active}<br>`;
        results.innerHTML += `- Pending: ${stats.pending}<br>`;
        testResults.admin = true;
      } catch (error) {
        document.getElementById('admin-results').innerHTML += `âŒ Stats error: ${error.message}<br>`;
      }
    }

    function testMemberManagement() {
      if (!memberPortal || !memberPortal.isLoggedIn()) {
        document.getElementById('admin-results').innerHTML += 'âŒ Login required for member management<br>';
        return;
      }

      if (memberPortal.currentUser.memberType === 'board') {
        document.getElementById('admin-results').innerHTML += 'âœ… Board member access - management available<br>';
      } else {
        document.getElementById('admin-results').innerHTML += 'âŒ Management access denied (board members only)<br>';
      }
    }

    function testRegistrationFlow() {
      if (!memberPortal) return;

      const testEmail = 'test@example.com';
      try {
        // Test registration validation
        const canRegister = !memberPortal.members[testEmail];
        document.getElementById('admin-results').innerHTML += `ðŸ“ Registration test: ${canRegister ? 'âœ… Available' : 'âŒ Email taken'}<br>`;
      } catch (error) {
        document.getElementById('admin-results').innerHTML += `âŒ Registration error: ${error.message}<br>`;
      }
    }

    // Test data persistence
    function testDataStorage() {
      try {
        const testKey = 'memberPortalTest';
        const testData = { test: true, timestamp: Date.now() };
        
        localStorage.setItem(testKey, JSON.stringify(testData));
        const retrieved = JSON.parse(localStorage.getItem(testKey));
        
        if (retrieved && retrieved.test) {
          document.getElementById('storage-results').innerHTML += 'âœ… LocalStorage working correctly<br>';
          localStorage.removeItem(testKey);
          testResults.storage = true;
        } else {
          document.getElementById('storage-results').innerHTML += 'âŒ LocalStorage test failed<br>';
        }
      } catch (error) {
        document.getElementById('storage-results').innerHTML += `âŒ Storage error: ${error.message}<br>`;
      }
    }

    function testSessionPersistence() {
      if (!memberPortal) return;

      const sessionData = localStorage.getItem('memberPortalSession');
      if (sessionData) {
        document.getElementById('storage-results').innerHTML += 'âœ… Session data found in storage<br>';
      } else {
        document.getElementById('storage-results').innerHTML += 'âš ï¸ No session data (expected if not logged in)<br>';
      }
    }

    function clearAllData() {
      try {
        localStorage.removeItem('memberPortalMembers');
        localStorage.removeItem('memberPortalSession');
        document.getElementById('storage-results').innerHTML += 'ðŸ—‘ï¸ All member portal data cleared<br>';
        refreshUserStatus();
      } catch (error) {
        document.getElementById('storage-results').innerHTML += `âŒ Clear error: ${error.message}<br>`;
      }
    }

    // Test integrations
    function testRSVPIntegration() {
      document.getElementById('integration-results').innerHTML += 'âœ… RSVP system integration ready<br>';
    }

    function testNewsletterIntegration() {
      document.getElementById('integration-results').innerHTML += 'âœ… Newsletter system integration ready<br>';
    }

    function testNotifications() {
      if (memberPortal) {
        memberPortal.showNotification('ðŸ§ª Test notification working!', 'success');
        document.getElementById('integration-results').innerHTML += 'âœ… Notification system working<br>';
      }
    }

    // Run all tests
    function runAllTests() {
      const results = document.getElementById('final-results');
      results.innerHTML = 'Running comprehensive test suite...<br><br>';

      // Clear previous results
      document.getElementById('auth-results').innerHTML = '';
      document.getElementById('benefits-results').innerHTML = '';
      document.getElementById('admin-results').innerHTML = '';
      document.getElementById('storage-results').innerHTML = '';
      document.getElementById('integration-results').innerHTML = '';

      // Run all tests
      setTimeout(() => {
        testDataStorage();
        testLogin('member@cvawvuaa.org', 'member123');
        testBenefits();
        testLogout();
        
        testLogin('premium@cvawvuaa.org', 'premium123');
        testBenefits();
        testMemberDirectory();
        testExclusiveContent();
        testLogout();

        testLogin('board@cvawvuaa.org', 'board123');
        testBenefits();
        testMemberStats();
        testMemberManagement();
        
        testNotifications();
        
        generateReport();
      }, 500);
    }

    // Generate test report
    function generateReport() {
      const passed = Object.values(testResults).filter(r => r === true).length;
      const total = Object.keys(testResults).length;
      
      let report = `<h4>ðŸŽ¯ Test Summary</h4>`;
      report += `<p><strong>Tests Passed:</strong> ${passed}/${total}</p>`;
      
      if (passed === total) {
        report += `<div style="background: #d4edda; padding: 12px; border-radius: 4px; color: #155724;">`;
        report += `ðŸŽ‰ <strong>All systems operational!</strong><br>`;
        report += `The Member Portal is fully functional and ready for production use.`;
        report += `</div>`;
      } else {
        report += `<div style="background: #f8d7da; padding: 12px; border-radius: 4px; color: #721c24;">`;
        report += `âš ï¸ <strong>Some tests failed.</strong><br>`;
        report += `Please review the individual test results above.`;
        report += `</div>`;
      }

      document.getElementById('final-results').innerHTML = report;
    }

    // Initialize when page loads
    document.addEventListener('DOMContentLoaded', () => {
      const initialized = initializeSystem();
      if (initialized) {
        refreshUserStatus();
      }
    });
  </script>
</body>
</html>
