<!doctype html><html lang="en">
<head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>RSVP</title>
<link rel="stylesheet" href="/css/styles.css">
<link rel="stylesheet" href="/assets/wvu-brand.css?v=40">
</head>
<body>
<header class="site">
  <div class="wrapper topbar">
    <a class="brand" href="/index.html" aria-label="CVCWVUAA">
      <img class="site-logo" src="/assets/logo.png" alt="CVCWVUAA logo">
    </a>
    <!-- Mobile menu button -->
    <button class="nav-toggle" aria-expanded="false" aria-controls="site-nav">‚ò∞</button>
    <nav id="site-nav" class="nav">
      <a href="/index.html">Home</a>
      <div class="menu dropdown">
        <button class="dropbtn" aria-haspopup="true" aria-expanded="false">About</button>
        <div class="dropdown-panel" role="menu" aria-label="About">
          <a role="menuitem" href="/about.html#about-chapter">About the Chapter</a>
          <a role="menuitem" href="/pay.html">Membership</a>
          <a role="menuitem" href="/board.html">Board Members</a>
          <a role="menuitem" href="/minutes.html">Meeting Minutes</a>
          <a role="menuitem" href="/bylaws.html">Bylaws ¬∑ Proclamation</a>
        </div>
      </div>
      <a href="/events.html">Events</a>
      <a href="/scores.html">Scores</a>
      <a href="/resources.html">Resources</a>
      <a href="/programs.html">Programs</a>
      <a href="/scholarship.html">Scholarship</a>
      <a href="/media.html">Media</a>
      <a href="/news.html">News</a>
    </nav>
  </div>
</header>
<main><div class="wrapper">
  <h2>RSVP</h2>
  <div id="event-info" class="card" style="margin-bottom: 24px; display: none;">
    <h3 id="event-title">Event Details</h3>
    <p id="event-details"></p>
  </div>
  
  <form id="rsvp-form" class="stack" method="POST" action="https://formsubmit.co/cvcwvuaa@gmail.com">
    <!-- FormSubmit configuration -->
    <input type="hidden" name="_subject" value="üé´ New RSVP: Event Registration">
    <input type="hidden" name="_template" value="box">
    <input type="hidden" name="_next" value="https://cvawvuaa.org/thanks.html?rsvp=1">
    <input type="hidden" name="_captcha" value="false">
    <input type="hidden" name="Event" id="event-name">

    <div class="form-grid">
      <!-- Contact Information -->
      <label style="grid-column: 1/-1;">Name *
        <input type="text" name="Name" autocomplete="name" required>
      </label>
      
      <!-- RSVP Response -->
      <div style="grid-column: 1/-1;">
        <fieldset style="border: 2px solid #EAAA00; padding: 20px; border-radius: 8px; background: #f8f9fa;">
          <legend style="padding: 0 12px; font-weight: 700; font-size: 1.1rem; color: #002855;">Will you attend? *</legend>
          <div style="display: flex; gap: 20px; flex-wrap: wrap; margin-top: 12px;">
            <label style="display: flex; align-items: center; gap: 8px; font-weight: normal; font-size: 1.05rem; cursor: pointer;">
              <input type="radio" name="Attending" value="Yes, I'll be there!" required style="width: 18px; height: 18px;">
              <span>‚úÖ Yes, I'll be there!</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; font-weight: normal; font-size: 1.05rem; cursor: pointer;">
              <input type="radio" name="Attending" value="Can't make it" required style="width: 18px; height: 18px;">
              <span>‚ùå Can't make it</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; font-weight: normal; font-size: 1.05rem; cursor: pointer;">
              <input type="radio" name="Attending" value="Maybe" required style="width: 18px; height: 18px;">
              <span>‚ùì Maybe</span>
            </label>
          </div>
        </fieldset>
      </div>
      
      <!-- Guest Information -->
      <label style="grid-column: 1/-1;">Number of Guests
        <input type="number" name="Number_of_Guests" min="0" max="10" value="0">
        <div class="small">How many additional guests will you bring?</div>
      </label>
      
      <!-- Comments -->
      <label style="grid-column: 1/-1;">Comments or Special Requests
        <textarea name="Comments" rows="4" placeholder="Dietary restrictions, accessibility needs, questions, etc."></textarea>
      </label>
    </div>
  <input type="hidden" name="eventId" id="eventId">
    <p>
      <button type="submit" class="btn">Send RSVP</button>
      <a class="btn" href="/events.html">Back to Events</a>
    </p>
    <p class="small">Your RSVP is sent to the chapter inbox and saved locally in your browser.</p>
  </form>

  <!-- Admin/local view (shows only with ?admin=1) -->
  <section id="rsvp-admin" class="card" style="display:none; margin-top:16px;">
    <div style="display:flex;justify-content:space-between;align-items:center;gap:.5rem;flex-wrap:wrap">
      <h3 style="margin:0">Local RSVPs (Private View)</h3>
      <div style="display:flex;gap:.5rem;flex-wrap:wrap">
        <button id="export-json" class="btn" type="button">Export JSON</button>
  <button id="export-csv" class="btn" type="button">Export CSV</button>
  <button id="export-emails" class="btn" type="button">Export Emails</button>
        <label class="btn" for="import-json" style="cursor:pointer">Import JSON</label>
        <input id="import-json" type="file" accept="application/json" style="display:none">
        <button id="clear-local" class="btn" type="button">Clear Local</button>
      </div>
    </div>
    <div class="small" style="color:#5b6777;margin:.5rem 0">Tip: Append <code>?admin=1</code> to the URL to show this panel.</div>
    <div class="table-wrap" style="overflow:auto">
      <table id="rsvp-table" style="width:100%;border-collapse:collapse">
        <thead>
          <tr>
            <th style="text-align:left;border-bottom:1px solid var(--border-color)">When</th>
            <th style="text-align:left;border-bottom:1px solid var(--border-color)">Name</th>
            <th style="text-align:left;border-bottom:1px solid var(--border-color)">Attending</th>
            <th style="text-align:left;border-bottom:1px solid var(--border-color)">Guests</th>
            <th style="text-align:left;border-bottom:1px solid var(--border-color)">Comments</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </section>
</div></main>
<script src="/js/rsvp.js"></script>
<script>
  // Save RSVP to localStorage before form submits
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('rsvp-form');
    
    if (form) {
      form.addEventListener('submit', (e) => {
        // Get form data
        const formData = new FormData(form);
        const rsvpData = {
          timestamp: new Date().toISOString(),
          Name: formData.get('Name') || '',
          Attending: formData.get('Attending') || '',
          Number_of_Guests: formData.get('Number_of_Guests') || 0,
          Comments: formData.get('Comments') || '',
          Event: formData.get('Event') || '',
          eventId: formData.get('eventId') || ''
        };
        
        // Get existing RSVPs from localStorage
        let rsvps = [];
        try {
          rsvps = JSON.parse(localStorage.getItem('rsvps') || '[]');
        } catch (e) {
          rsvps = [];
        }
        
        // Add new RSVP
        rsvps.push(rsvpData);
        
        // Save back to localStorage
        localStorage.setItem('rsvps', JSON.stringify(rsvps));
        
        console.log('RSVP saved to localStorage:', rsvpData);
        console.log('Total RSVPs:', rsvps.length);
        
        // Let form submit normally to FormSubmit
      });
    }
    
    // Auto-load event from URL parameter
    const urlParams = new URLSearchParams(window.location.search);
    const eventSlug = urlParams.get('event');
    
    if (eventSlug) {
      // Set the event ID
      document.getElementById('eventId').value = eventSlug;
      
      // Convert slug to readable event name
      const eventName = eventSlug
        .replace(/-/g, ' ')
        .replace(/\b\w/g, l => l.toUpperCase());
      
      document.getElementById('event-name').value = eventName;
      
      // Show event info card
      const eventInfo = document.getElementById('event-info');
      const eventTitle = document.getElementById('event-title');
      const eventDetails = document.getElementById('event-details');
      
      if (eventInfo && eventTitle && eventDetails) {
        eventTitle.textContent = eventName;
        eventDetails.innerHTML = `<p style="margin: 0; font-size: 1.05rem;">You're RSVPing for: <strong>${eventName}</strong></p>`;
        eventInfo.style.display = 'block';
      }
    }
  });
</script>

<!-- Enhanced RSVP Management System -->
<script src="/js/rsvp-manager.js"></script>

<footer class="site-footer">
  <div class="wrapper">
    <div class="footer-bar">
      <div class="brandline">CVCWVUAA ‚Äî Central Virginia Chapter</div>
  <a href="/contact.html">Contact Us</a>
    </div>
    <div class="small footer-meta">¬© <span id="year"></span> CVCWVUAA ‚Äî Central Virginia Chapter of the WVU Alumni Association. All rights reserved. WVU and West Virginia University are trademarks of West Virginia University. This site is not an official publication of West Virginia University.</div>
  </div>
</footer>
</body>
<script>
  (function(){
    const navBtn = document.querySelector('.nav-toggle');
    const nav = document.getElementById('site-nav');
    if (navBtn && nav) {
      navBtn.addEventListener('click', () => {
        const open = nav.classList.toggle('open');
        navBtn.setAttribute('aria-expanded', open ? 'true' : 'false');
      });
    }
    const aboutMenu = document.querySelector('.menu.dropdown');
    const aboutBtn  = document.querySelector('.menu.dropdown .dropbtn');
    if (aboutBtn && aboutMenu) {
      aboutBtn.addEventListener('click', (e) => {
        if (window.matchMedia('(max-width: 900px)').matches) {
          e.preventDefault();
          aboutMenu.classList.toggle('open');
          aboutBtn.setAttribute('aria-expanded', aboutMenu.classList.contains('open') ? 'true' : 'false');
        }
      });
    }
  })();
</script>
</html>
