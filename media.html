<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CVCWVUAA • Media Uploads</title>
  
  <!-- WVU Official Fonts -->
  <link rel="preconnect" href="https://cdn.fonts.net">
  <link href="https://cdn.fonts.net/kit/e691d6b8-16c1-4a77-83c8-72cc198cb2dd/e691d6b8-16c1-4a77-83c8-72cc198cb2dd.css" rel="stylesheet">
  
  <link rel="stylesheet" href="/css/styles.css">
  <link rel="stylesheet" href="/css/wvu-components.css">
  <link rel="stylesheet" href="/css/wvu-cta.css">
  <link rel="stylesheet" href="/css/wvu-breadcrumbs.css">
  <style>
    .gallery-grid { display:grid; gap:16px; grid-template-columns:1fr; }
    @media (min-width:780px) { .gallery-grid { grid-template-columns:1fr 1fr 1fr; } }
    .small { font-size:14px }
    figure.card { background:#fff; border-radius:8px; box-shadow:0 1px 3px rgba(0,0,0,0.15); overflow:hidden; }
    figure.card img, figure.card video { display:block; width:100%; height:220px; object-fit:cover; }
    figure.card figcaption { padding:8px; }
  </style>
</head>
<body>
  <a href="#main-content" class="skip-to-main">Skip to main content</a>
  
  <!-- WVU Components -->
  <div id="wvu-masthead"></div>
  <div id="wvu-navigation"></div>
  
  <!-- Breadcrumb Navigation -->
  <div id="wvu-breadcrumbs"></div>

<main id="main-content"><div class="wrapper">

  <h2>Share Your Photos</h2>
  <p class="small">
    Please compress your photos into a single <strong>.zip</strong> file and upload it here.<br>
    Example filename: <code>watch-party-2025-10-12-j-smith.zip</code>
  </p>
  <p class="small">Please compress your photos into a single <strong>.zip</strong> and upload it here. Example: <code>watch-party-2025-10-12-j-smith.zip</code></p>
  <p class="small">Uploads are reviewed by our volunteers and may be featured. Thank you!</p>

  <form class="stack" action="https://formsubmit.co/president@cvawvuaa.org" method="POST" enctype="multipart/form-data">
    <input type="hidden" name="_subject" value="CVCWVUAA Photo Upload (ZIP)">
    <input type="hidden" name="_captcha" value="false">
    <input type="hidden" name="_next" value="https://cvawvuaa.org/thanks.html">
    <!-- Honeypot: bots will fill this, humans won't (hidden) -->
    <div style="position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden">
      <label>Leave this field empty <input type="text" name="website" tabindex="-1" autocomplete="off"></label>
    </div>

    <div class="row">
      <label>Your Name
        <input type="text" name="Name" required>
      </label>
      <label>Email
        <input type="email" name="Email" required>
      </label>
      <label>Your Name <input type="text" name="Name" required></label>
      <label>Email <input type="email" name="Email" required></label>
    </div>

    <label>Event / Caption
      <input type="text" name="Caption" placeholder="Event name, date, brief caption">
    </label>

    <label>Event / Caption <input type="text" name="Caption" placeholder="Event name, date, brief caption"></label>
    <fieldset class="card" style="border:none">
      <legend><strong>Upload your ZIP file</strong></legend>
      <p class="small" style="margin-top:0">Select one .zip file. If your photos are large, create multiple ZIPs and submit separately.</p>
      <p class="small" style="margin-top:0">Select one .zip file. If large, split into multiple ZIPs and submit each.</p>
      <input type="file" name="attachment" accept=".zip" required>
    </fieldset>

    <label>Message (optional)
      <textarea name="Message" rows="3" placeholder="Anything we should know?"></textarea>
    </label>

    <label>Message (optional) <textarea name="Message" rows="3" placeholder="Anything we should know?"></textarea></label>
    <button class="wvu-cta wvu-cta--primary" type="submit">
      <span class="wvu-cta__icon wvu-cta__icon--left">📦</span>
      Send ZIP
    </button>
  </form>

  <h2 style="margin-top:28px">Chapter Gallery</h2>
  <div id="gallery-grid" class="gallery-grid"></div>

</div></main>

  <!-- Footer Component -->
  <div id="wvu-footer"></div>

<script>
</script>

<script>
// Gallery loader
(async function () {
  const grid = document.getElementById('gallery-grid');

  function note(html, color="#8a5300"){
    const msg = document.createElement('div');
    msg.className = 'card';
    msg.style.padding = '12px';
    msg.innerHTML = `<div class="small" style="color:${color}">${html}</div>`;
    grid && grid.prepend(msg);
  }

  async function loadJSON() {
    const urls = ['content/gallery.json', '/content/gallery.json'];
    for (const u of urls) {
      try {
        const r = await fetch(u, { cache: 'no-store' });
        if (r.ok) return await r.json();
      } catch {}
    }
    throw new Error('Unable to load gallery.json');
  }

  function norm(src) { return src && src.startsWith('/') ? src : src; }

  function cardFor(item){
    const fig = document.createElement('figure');
    fig.className = 'card';
    if(item.type === 'video'){
      const v = document.createElement('video');
      v.controls = true; v.playsInline = true; v.preload = "metadata";
      v.style.cssText = 'width:100%;height:220px;object-fit:cover';
      if(item.poster) v.poster = norm(item.poster);
      const source = document.createElement('source');
      source.src = norm(item.src);
      source.type = 'video/mp4';
      v.appendChild(source);
      fig.appendChild(v);
    } else {
      const img = document.createElement('img');
      img.src = norm(item.src);
      img.alt = item.alt || '';
      fig.appendChild(img);
    }
    const cap = document.createElement('figcaption');
    const meta = [item.credit || '', item.date || ''].filter(Boolean).join(' • ');
    cap.innerHTML = `<div><strong>${item.caption || ''}</strong></div>
                     <div class="small" style="color:#5b6777">${meta}</div>`;
    fig.appendChild(cap);
    return fig;
  }

  try{
    const items = await loadJSON();
    if(!Array.isArray(items) || !items.length){
      note('No media yet. Add entries in <code>content/gallery.json</code>.');
      return;
    }
    grid.innerHTML = '';
    items.forEach(it => grid.appendChild(cardFor(it)));
  }catch(e){
    console.error(e);
    note('Gallery load error. Make sure <code>content/gallery.json</code> exists and images are uploaded.');
  }
})();
</script>

<!-- WVU Component Loaders -->
<script src="/includes/component-loader.js"></script>
<script src="/js/wvu-breadcrumbs.js"></script>

</body>
</html>
