<!doctype html><html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>CVCWVUAA ‚Ä¢ Events</title>
<meta name="description" content="Join CVCWVUAA events! Game watch parties, social gatherings, alumni meetups, and community service events for West Virginia University alumni in Central Virginia.">
<link rel="stylesheet" href="/css/styles.css">
<link rel="stylesheet" href="/css/social-media.css">
</head><body>

<header class="site">
  <div class="wrapper topbar">
    <a class="brand" href="/index.html" aria-label="CVCWVUAA">
      <img class="site-logo" src="/assets/logo.png" alt="CVCWVUAA logo">
    </a>

    <!-- Mobile menu button -->
    <button class="nav-toggle" aria-expanded="false" aria-controls="site-nav">‚ò∞</button>

    <nav id="site-nav" class="nav">
      <a href="/index.html">Home</a>

      <!-- Dropdown -->
      <div class="menu dropdown">
        <button class="dropbtn" aria-haspopup="true" aria-expanded="false">About</button>
        <div class="dropdown-panel" role="menu" aria-label="About">
          <a role="menuitem" href="/about.html#about-chapter">About the Chapter</a>
          <a role="menuitem" href="/pay.html">Membership</a>
          <a role="menuitem" href="/board.html">Board Members</a>
          <a role="menuitem" href="/minutes.html">Meeting Minutes</a>
          <a role="menuitem" href="/bylaws.html">Bylaws ¬∑ Proclamation</a>
        </div>
      </div>

      <a href="/events.html">Events</a>

      <!-- News Dropdown -->
      <div class="menu dropdown">
        <button class="dropbtn" aria-haspopup="true" aria-expanded="false">News</button>
        <div class="dropdown-panel" role="menu" aria-label="News">
          <a role="menuitem" href="/news/">News</a>
          <a role="menuitem" href="/newsletters/">Newsletters</a>
          <a role="menuitem" href="/alumni-spotlight.html">Alumni Spotlight</a>
        </div>
      </div>

      <a href="/scores.html">Scores</a>
      <a href="/resources.html">Resources</a>
      <a href="/programs.html">Programs</a>
      <a href="/scholarship.html">Scholarship</a>
      <a href="/media.html">Media</a>
      <a href="/contact.html">Contact</a>
      <a href="/member-portal.html" class="member-portal-link">üîê Members</a>
      <a href="/search.html" class="search-btn">üîç</a>
      
      <!-- Theme toggle -->
      <button class="theme-toggle" aria-label="Toggle theme">üåô</button>
    </nav>
  </div>
</header>

<main><div class="wrapper">
  <div class="photo-strip"><img src="/assets/photos/download.jpg" alt="WVU"><img src="/assets/photos/download (10).jpg" alt="WVU"><img src="/assets/photos/550539255_10163868473745295_3650245405852649566_n.jpg" alt="WVU"><img src="/assets/photos/watch party carolina ale house.jpg" alt="WVU"><img src="/assets/photos/82279131_2510255619097031_4820471456792051712_n.jpg" alt="WVU"><img src="/assets/photos/509803515_10230940383442184_7809526464395943925_n.jpg" alt="WVU"><img src="/assets/photos/509914204_10230940387802293_7404552104597369588_n.jpg" alt="WVU"><img src="/assets/photos/509971801_10230940388282305_467355079869857461_n.jpg" alt="WVU"></div>
  <h2>Upcoming Events</h2>
  <div id="events-upcoming" class="grid" style="grid-template-columns:1fr;gap:16px"></div>
  <p class="small">Tip: Click RSVP to open the detailed RSVP page pre-filled for the event.</p>
  <h3 style="margin-top:18px">Past Events</h3>
  <div id="events-past" class="grid" style="grid-template-columns:1fr;gap:16px"></div>

  <!-- Social Media Section -->
  <section class="social-section">
    <div class="wrapper">
      <div class="social-grid">
        <div class="social-links"></div>
        <div class="share-buttons"></div>
      </div>
      <div class="social-feed"></div>
    </div>
  </section>

  <!-- Mailchimp Newsletter Signup -->
  <div class="mailchimp-signup-container" 
       data-title="Never Miss an Event!" 
       data-description="Subscribe to get notified about upcoming CVCWVUAA events and activities!"
       data-include-phone="false"
       data-include-gradyear="true">
  </div>

</div></main>

<footer class="site-footer">
  <div class="wrapper">
    <div class="footer-bar">
      <div class="brandline">CVCWVUAA ‚Äî Central Virginia Chapter</div>
  <a href="/contact.html">Contact Us</a>
    </div>
    <div class="small footer-meta">¬© <span id="year"></span> CVCWVUAA ‚Äî Central Virginia Chapter of the WVU Alumni Association. All rights reserved. WVU and West Virginia University are trademarks of West Virginia University. This site is not an official publication of West Virginia University.</div>
  </div>
</footer>

<script>
  // year stamp
  document.getElementById('year') && (document.getElementById('year').textContent = new Date().getFullYear());
</script>
<script>
  // Render events from events/events.json
  (async function(){
    const up = document.getElementById('events-upcoming');
    const past = document.getElementById('events-past');
    try{
      const res = await fetch('/events/events.json', {cache:'no-store'});
      let events = await res.json();
      if(!Array.isArray(events)) events = [];
      const now = new Date();
      const pub = events.filter(e => e && e.published !== false);
      if(!pub.length){
        up.innerHTML = '<div class="card">No upcoming events have been posted yet. Check back soon!</div>';
        return;
      }
      // Sort and split
      pub.sort((a,b)=> String(a.date||'').localeCompare(String(b.date||'')));
      const upcoming = pub.filter(e => e.date && new Date(e.date) >= new Date(now.toDateString()));
      const pastList = pub.filter(e => !e.date || new Date(e.date) < new Date(now.toDateString())).reverse();

      function icsFor(e){
        const dt = e.date ? new Date(e.date) : null;
        const dtStamp = new Date();
        function fmt(d){
          const pad=n=>String(n).padStart(2,'0');
          return `${d.getUTCFullYear()}${pad(d.getUTCMonth()+1)}${pad(d.getUTCDate())}T${pad(d.getUTCHours())}${pad(d.getUTCMinutes())}00Z`;
        }
        const start = dt ? fmt(dt) : fmt(new Date());
        // if time is HH:MM, try to keep; else default 1 hour
        let endDate = dt ? new Date(dt) : new Date();
        if(e.time){
          const m = String(e.time).match(/(\d{1,2}):(\d{2})/);
          if(m){ endDate.setHours(Number(m[1])+1, Number(m[2])); }
          else { endDate.setHours(endDate.getHours()+1); }
        } else { endDate.setHours(endDate.getHours()+1); }
        const end = fmt(endDate);
        const uid = `${(e.slug||'event')}-${Date.now()}@cvawvuaa.org`;
        const ics = [
          'BEGIN:VCALENDAR','VERSION:2.0','PRODID:-//CVCWVUAA//Events//EN','BEGIN:VEVENT',
          `UID:${uid}`,
          `DTSTAMP:${fmt(dtStamp)}`,
          `DTSTART:${start}`,
          `DTEND:${end}`,
          `SUMMARY:${(e.title||'').replace(/\n/g,' ')}`,
          `LOCATION:${(e.location||'').replace(/\n/g,' ')}`,
          `DESCRIPTION:${(e.description||'').replace(/\n/g,' ')}`,
          'END:VEVENT','END:VCALENDAR'
        ].join('\r\n');
        const blob = new Blob([ics], {type:'text/calendar'});
        return URL.createObjectURL(blob);
      }

      function renderList(list, container){
        container.innerHTML = '';
        for(const e of list){
        const dateStr = e.date ? new Date(e.date).toLocaleDateString(undefined, {weekday:'short', month:'short', day:'numeric', year:'numeric'}) : '';
        const timeStr = e.time ? ` ‚Ä¢ ${e.time}` : '';
        const where = e.location ? `<div class="small" style="color:#5b6777">${e.location}</div>` : '';
        const desc = e.description ? `<p>${e.description}</p>` : '';
        const rsvpUrl = `/events/rsvp.html?event=${encodeURIComponent(e.slug||'')}&eventId=${encodeURIComponent(e.slug||'')}`;
        const card = document.createElement('section'); card.className='card'; card.style.padding='12px';
        
        // Load RSVP stats for this event if available
        const rsvpStats = window.rsvpManager ? window.rsvpManager.getRSVPStats(e.slug) : null;
        const rsvpCount = rsvpStats ? ` (${rsvpStats.attending} attending)` : '';
        
        card.innerHTML = `
          <h3 style="margin-top:0">${(e.title||'').replace(/&/g,'&amp;')}</h3>
          <div class="small" style="color:#5b6777">${dateStr}${timeStr}</div>
          ${where}
          ${desc}
          <div style="margin-top:8px;display:flex;gap:8px;flex-wrap:wrap;align-items:center;">
            <a class="btn" href="${rsvpUrl}">üé´ RSVP${rsvpCount}</a>
            <a class="btn outline" href="${icsFor(e)}" download="${(e.slug||'event')}.ics">üìÖ Add to Calendar</a>
            ${rsvpStats && rsvpStats.total > 0 ? `<span class="small" style="color:#5b6777;">${rsvpStats.total} responses</span>` : ''}
          </div>
        `;
        container.appendChild(card);
      }
      }

      renderList(upcoming, up);
      renderList(pastList, past);
    }catch(err){ if(up) up.innerHTML = '<div class="card">Unable to load events.</div>'; }
  })();
</script>
<script>
  // Mobile: open/close main nav
  const navBtn = document.querySelector('.nav-toggle');
  const nav = document.getElementById('site-nav');
  if (navBtn && nav) {
    navBtn.addEventListener('click', () => {
      const open = nav.classList.toggle('open');
      navBtn.setAttribute('aria-expanded', open ? 'true' : 'false');
    });
  }
  // Mobile: tap to open About dropdown
  const aboutMenu = document.querySelector('.menu.dropdown');
  const aboutBtn  = document.querySelector('.menu.dropdown .dropbtn');
  if (aboutBtn && aboutMenu) {
    aboutBtn.addEventListener('click', (e) => {
      if (window.matchMedia('(max-width: 900px)').matches) {
        e.preventDefault();
        aboutMenu.classList.toggle('open');
        aboutBtn.setAttribute('aria-expanded', aboutMenu.classList.contains('open') ? 'true' : 'false');
      }
    });
  }
</script>

<!-- RSVP Management System -->
<script src="/js/rsvp-manager.js"></script>

<!-- Social Media Integration -->
<script src="/js/social-media.js"></script>

<!-- Mailchimp Integration -->
<script src="/js/mailchimp-integration.js"></script>
<script>
  // Initialize social media when page loads
  document.addEventListener('DOMContentLoaded', () => {
    // Load social account URLs and update links
    const savedAccounts = localStorage.getItem('cvcwvuaa-social-accounts');
    if (savedAccounts) {
      const accounts = JSON.parse(savedAccounts);
      const socialLinks = document.querySelectorAll('.social-link');
      socialLinks.forEach(link => {
        if (link.classList.contains('facebook') && accounts.facebook) {
          link.href = accounts.facebook;
        } else if (link.classList.contains('twitter') && accounts.twitter) {
          link.href = accounts.twitter;
        } else if (link.classList.contains('instagram') && accounts.instagram) {
          link.href = accounts.instagram;
        } else if (link.classList.contains('linkedin') && accounts.linkedin) {
          link.href = accounts.linkedin;
        }
      });
    }
  });
</script>

</body></html>
