<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Text Notifications Sign-Up - CVCWVUAA</title>
<link rel="stylesheet" href="/css/styles.css">
<link rel="stylesheet" href="/assets/wvu-brand.css?v=40">
</head>
<body>
<header class="site">
  <div class="wrapper topbar">
    <a class="brand" href="/index.html" aria-label="CVCWVUAA">
      <img class="site-logo" src="/assets/logo.png" alt="CVCWVUAA logo">
    </a>
    <button class="nav-toggle" aria-expanded="false" aria-controls="site-nav">‚ò∞</button>
    <nav id="site-nav" class="nav">
      <a href="/index.html">Home</a>
      <div class="menu dropdown">
        <button class="dropbtn" aria-haspopup="true" aria-expanded="false">About</button>
        <div class="dropdown-panel" role="menu" aria-label="About">
          <a role="menuitem" href="/about.html#about-chapter">About the Chapter</a>
          <a role="menuitem" href="/pay.html">Membership</a>
          <a role="menuitem" href="/board.html">Board Members</a>
          <a role="menuitem" href="/minutes.html">Meeting Minutes</a>
          <a role="menuitem" href="/bylaws.html">Bylaws ¬∑ Proclamation</a>
        </div>
      </div>
      <a href="/events.html">Events</a>
      <a href="/scores.html">Scores</a>
      <a href="/resources.html">Resources</a>
      <a href="/programs.html">Programs</a>
      <a href="/scholarship.html">Scholarship</a>
      <a href="/media.html">Media</a>
      <a href="/news.html">News</a>
    </nav>
  </div>
</header>

<main>
<div class="wrapper">
  <h1>üì± Text Notification Sign-Up</h1>
  
  <div class="card" style="max-width: 700px; margin: 0 auto;">
    <p style="font-size: 1.1rem; line-height: 1.7;">
      Want to receive game watch reminders and chapter updates via text message? 
      Sign up below and we'll add you to our text notification list!
    </p>
    
    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin: 20px 0;">
      <strong>üìã What you'll receive:</strong>
      <ul style="margin: 10px 0;">
        <li>Game watch reminders (day before events)</li>
        <li>Last-minute event updates</li>
        <li>Important chapter announcements</li>
      </ul>
      <p style="margin: 10px 0 0 0; font-size: 0.95rem;">
        <strong>Frequency:</strong> Typically 2-4 messages per month. You can opt-out anytime by replying STOP.
      </p>
    </div>
    
    <form method="POST" action="https://formsubmit.co/cvcwvuaa@gmail.com" class="stack">
      <!-- FormSubmit configuration -->
      <input type="hidden" name="_subject" value="üì± New Text Notification Sign-Up">
      <input type="hidden" name="_template" value="box">
      <input type="hidden" name="_next" value="https://cvawvuaa.org/thanks.html?text=1">
      <input type="hidden" name="_captcha" value="false">
      
      <div class="form-grid">
        <label style="grid-column: 1/-1;">
          Full Name *
          <input type="text" name="Name" autocomplete="name" required>
        </label>
        
        <label style="grid-column: 1/-1;">
          Phone Number *
          <input type="tel" name="Phone" autocomplete="tel" required pattern="[0-9\-\(\)\s\+]+" placeholder="(555) 123-4567">
          <div class="small">Include area code. We'll only use this for chapter text notifications.</div>
        </label>
        
        <label style="grid-column: 1/-1;">
          Email (Optional)
          <input type="email" name="Email" autocomplete="email" placeholder="your@email.com">
          <div class="small">In case we need to reach you about your text preferences.</div>
        </label>
        
        <div style="grid-column: 1/-1;">
          <fieldset style="border: 2px solid #EAAA00; padding: 20px; border-radius: 8px; background: #f8f9fa;">
            <legend style="padding: 0 12px; font-weight: 700; color: #002855;">Notification Preferences</legend>
            <div style="margin-top: 12px;">
              <label style="display: flex; align-items: start; gap: 8px; margin: 8px 0; cursor: pointer;">
                <input type="checkbox" name="Game_Watch_Reminders" value="Yes" checked style="margin-top: 4px;">
                <span>üèà Game watch reminders (day before events)</span>
              </label>
              <label style="display: flex; align-items: start; gap: 8px; margin: 8px 0; cursor: pointer;">
                <input type="checkbox" name="Event_Updates" value="Yes" checked style="margin-top: 4px;">
                <span>üìÖ Event updates and changes</span>
              </label>
              <label style="display: flex; align-items: start; gap: 8px; margin: 8px 0; cursor: pointer;">
                <input type="checkbox" name="Chapter_News" value="Yes" style="margin-top: 4px;">
                <span>üì∞ General chapter news and announcements</span>
              </label>
            </div>
          </fieldset>
        </div>
        
        <label style="grid-column: 1/-1;">
          Mobile Carrier (Optional)
          <select name="Carrier">
            <option value="">Select your carrier...</option>
            <option value="Verizon">Verizon</option>
            <option value="AT&T">AT&T</option>
            <option value="T-Mobile">T-Mobile</option>
            <option value="Sprint">Sprint</option>
            <option value="Cricket">Cricket Wireless</option>
            <option value="Metro">Metro by T-Mobile</option>
            <option value="Boost">Boost Mobile</option>
            <option value="Other">Other</option>
          </select>
          <div class="small">Helps us ensure messages are delivered properly.</div>
        </label>
      </div>
      
      <div style="background: #e7f3ff; padding: 15px; border-radius: 8px; margin: 20px 0; font-size: 0.9rem;">
        <strong>üìå Privacy Notice:</strong> Your phone number will only be used for chapter communications. 
        We will never share your number with third parties. Reply STOP to any text to unsubscribe anytime.
      </div>
      
      <p>
        <button type="submit" class="btn">üì± Sign Me Up for Texts</button>
        <a class="btn" href="/index.html">Cancel</a>
      </p>
    </form>
  </div>
  
  <!-- Admin/local view -->
  <section id="text-admin" class="card" style="display:none; margin-top:32px; max-width: 900px; margin-left: auto; margin-right: auto;">
    <div style="display:flex;justify-content:space-between;align-items:center;gap:.5rem;flex-wrap:wrap">
      <h3 style="margin:0">üì± Text Sign-Ups (Private View)</h3>
      <div style="display:flex;gap:.5rem;flex-wrap:wrap">
        <button id="export-phones-json" class="btn" type="button">Export JSON</button>
        <button id="export-phones-csv" class="btn" type="button">Export CSV</button>
        <button id="export-phone-list" class="btn" type="button">Export Phone Numbers</button>
        <button id="clear-local-phones" class="btn" type="button">Clear Local</button>
      </div>
    </div>
    <div class="small" style="color:#5b6777;margin:.5rem 0">Tip: Append <code>?admin=1</code> to the URL to show this panel.</div>
    <div class="table-wrap" style="overflow:auto">
      <table id="phone-table" style="width:100%;border-collapse:collapse">
        <thead>
          <tr>
            <th style="text-align:left;border-bottom:1px solid var(--border-color)">When</th>
            <th style="text-align:left;border-bottom:1px solid var(--border-color)">Name</th>
            <th style="text-align:left;border-bottom:1px solid var(--border-color)">Phone</th>
            <th style="text-align:left;border-bottom:1px solid var(--border-color)">Email</th>
            <th style="text-align:left;border-bottom:1px solid var(--border-color)">Carrier</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </section>
</div>
</main>

<script>
// Save to localStorage and show admin panel if ?admin=1
document.addEventListener('DOMContentLoaded', () => {
  const form = document.querySelector('form');
  const urlParams = new URLSearchParams(window.location.search);
  
  // Show admin panel if ?admin=1
  if (urlParams.get('admin') === '1') {
    document.getElementById('text-admin').style.display = 'block';
    loadPhoneSignups();
  }
  
  // Save form data to localStorage before submit
  if (form) {
    form.addEventListener('submit', (e) => {
      const formData = new FormData(form);
      const signupData = {
        timestamp: new Date().toISOString(),
        Name: formData.get('Name') || '',
        Phone: formData.get('Phone') || '',
        Email: formData.get('Email') || '',
        Carrier: formData.get('Carrier') || '',
        Game_Watch_Reminders: formData.get('Game_Watch_Reminders') || 'No',
        Event_Updates: formData.get('Event_Updates') || 'No',
        Chapter_News: formData.get('Chapter_News') || 'No'
      };
      
      let signups = [];
      try {
        signups = JSON.parse(localStorage.getItem('text-signups') || '[]');
      } catch (e) {
        console.error('Error reading localStorage:', e);
      }
      
      signups.push(signupData);
      localStorage.setItem('text-signups', JSON.stringify(signups));
    });
  }
  
  // Admin functions
  document.getElementById('export-phones-json')?.addEventListener('click', exportJSON);
  document.getElementById('export-phones-csv')?.addEventListener('click', exportCSV);
  document.getElementById('export-phone-list')?.addEventListener('click', exportPhoneList);
  document.getElementById('clear-local-phones')?.addEventListener('click', clearLocal);
});

function loadPhoneSignups() {
  const tbody = document.querySelector('#phone-table tbody');
  if (!tbody) return;
  
  let signups = [];
  try {
    signups = JSON.parse(localStorage.getItem('text-signups') || '[]');
  } catch (e) {
    console.error('Error reading localStorage:', e);
  }
  
  if (signups.length === 0) {
    tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;padding:2rem;color:#5b6777">No sign-ups yet</td></tr>';
    return;
  }
  
  tbody.innerHTML = '';
  signups.forEach(s => {
    const row = document.createElement('tr');
    const ts = s.timestamp ? new Date(s.timestamp).toLocaleString() : 'N/A';
    row.innerHTML = `
      <td style="padding:.5rem;border-bottom:1px solid var(--border-color)">${ts}</td>
      <td style="padding:.5rem;border-bottom:1px solid var(--border-color)">${s.Name || 'N/A'}</td>
      <td style="padding:.5rem;border-bottom:1px solid var(--border-color)"><strong>${s.Phone || 'N/A'}</strong></td>
      <td style="padding:.5rem;border-bottom:1px solid var(--border-color)">${s.Email || '‚Äî'}</td>
      <td style="padding:.5rem;border-bottom:1px solid var(--border-color)">${s.Carrier || '‚Äî'}</td>
    `;
    tbody.appendChild(row);
  });
}

function exportJSON() {
  const signups = JSON.parse(localStorage.getItem('text-signups') || '[]');
  const blob = new Blob([JSON.stringify(signups, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'text-signups-' + new Date().toISOString().split('T')[0] + '.json';
  a.click();
}

function exportCSV() {
  const signups = JSON.parse(localStorage.getItem('text-signups') || '[]');
  if (signups.length === 0) {
    alert('No sign-ups to export');
    return;
  }
  
  let csv = 'Timestamp,Name,Phone,Email,Carrier,Game Watch,Event Updates,Chapter News\n';
  signups.forEach(s => {
    const ts = s.timestamp ? new Date(s.timestamp).toLocaleString() : '';
    csv += `"${ts}","${s.Name || ''}","${s.Phone || ''}","${s.Email || ''}","${s.Carrier || ''}","${s.Game_Watch_Reminders || 'No'}","${s.Event_Updates || 'No'}","${s.Chapter_News || 'No'}"\n`;
  });
  
  const blob = new Blob([csv], { type: 'text/csv' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'text-signups-' + new Date().toISOString().split('T')[0] + '.csv';
  a.click();
}

function exportPhoneList() {
  const signups = JSON.parse(localStorage.getItem('text-signups') || '[]');
  if (signups.length === 0) {
    alert('No phone numbers to export');
    return;
  }
  
  // Just phone numbers, one per line
  const phones = signups.map(s => s.Phone).filter(p => p).join('\n');
  
  const blob = new Blob([phones], { type: 'text/plain' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'phone-numbers-' + new Date().toISOString().split('T')[0] + '.txt';
  a.click();
}

function clearLocal() {
  if (!confirm('Clear all local text sign-ups?')) return;
  localStorage.removeItem('text-signups');
  loadPhoneSignups();
  alert('Cleared!');
}
</script>

<script src="/js/menu.js"></script>
</body>
</html>
