<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Connection Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-box {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 { color: #002855; }
        .status { 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 5px;
            font-weight: bold;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <!-- WVU Masthead Component -->
    <div id="wvu-masthead"></div>

    <!-- WVU Primary Navigation Component -->
    <div id="wvu-navigation"></div>

    <div class="test-box">
        <h1>üî• Firebase Connection Test</h1>
        <p>This test will verify if Firebase can connect with your configuration.</p>
        
        <div id="status"></div>
        <div id="details"></div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <!-- Inline Config to Bypass Cache -->
    <script>
        // INLINE CONFIG - Bypasses all caching issues!
        const firebaseConfig = {
            apiKey: "AIzaSyDIMIbLTc2OgTTu6qFYdGgzO8CYU-rGmec",
            authDomain: "cvcwvuaa-904e2.firebaseapp.com",
            projectId: "cvcwvuaa-904e2",
            storageBucket: "cvcwvuaa-904e2.firebasestorage.app",
            messagingSenderId: "182842873773",
            appId: "1:182842873773:web:cbee30eeff8fee4c2ff324",
            measurementId: "G-5ZYMGSZBJ3"
        };

        const statusDiv = document.getElementById('status');
        const detailsDiv = document.getElementById('details');

        function showStatus(message, type) {
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        function showDetails(title, data) {
            detailsDiv.innerHTML += `<h3>${title}</h3><pre>${JSON.stringify(data, null, 2)}</pre>`;
        }

        // Test Firebase Connection
        try {
            showStatus('‚è≥ Initializing Firebase...', 'info');
            
            // Initialize Firebase
            const app = firebase.initializeApp(firebaseConfig);
            const db = firebase.firestore();
            
            showStatus('‚úÖ Firebase initialized successfully!', 'success');
            showDetails('Firebase Config', firebaseConfig);
            
            // Test Firestore connection
            showStatus('‚è≥ Testing Firestore connection...', 'info');
            
            db.collection('test').limit(1).get()
                .then(() => {
                    showStatus('‚úÖ SUCCESS! Firestore connected properly!', 'success');
                    detailsDiv.innerHTML += `
                        <div class="status success" style="margin-top: 20px;">
                            <h2>üéâ Your Firebase is Working!</h2>
                            <p>Your configuration is correct and Firestore is accessible.</p>
                            <p><strong>Project ID:</strong> ${firebaseConfig.projectId}</p>
                            <p><strong>Next Step:</strong> The ledger should work now!</p>
                        </div>
                    `;
                })
                .catch((error) => {
                    showStatus('‚ùå Firestore connection failed', 'error');
                    showDetails('Error Details', {
                        code: error.code,
                        message: error.message,
                        stack: error.stack
                    });
                });
                
        } catch (error) {
            showStatus('‚ùå Firebase initialization failed', 'error');
            showDetails('Error Details', {
                code: error.code,
                message: error.message,
                stack: error.stack
            });
        }
    </script>
    <!-- WVU Footer Component -->
    <div id="wvu-footer"></div>

    <!-- Load WVU Components -->
    <script src="/includes/component-loader.min.js"></script>
</body>
</html>
