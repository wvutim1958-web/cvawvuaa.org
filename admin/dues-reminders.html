<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Automated Dues Reminders - CVCWVUAA Admin">
    <title>Dues Reminders - CVCWVUAA Admin</title>
    
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/wvu-components.min.css">
    <link rel="stylesheet" href="/admin/css/admin-hub.css">
    
    <style>
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .page-header {
            background: linear-gradient(135deg, #8b5cf6, #6366f1);
            color: white;
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
        }
        
        .page-header h1 {
            margin: 0 0 0.5rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 0.5rem;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #4a90e2;
        }
        
        .settings-panel {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        
        .settings-panel h2 {
            margin: 0 0 1.5rem;
            color: #003057;
        }
        
        .setting-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #003057;
        }
        
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #4a90e2;
        }
        
        .reminder-list {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .reminder-list h2 {
            margin: 0 0 1.5rem;
            color: #003057;
        }
        
        .reminder-item {
            padding: 1.5rem;
            border-left: 4px solid #4a90e2;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 1rem;
        }
        
        .reminder-item.pending {
            border-left-color: #fbbf24;
        }
        
        .reminder-item.sent {
            border-left-color: #10b981;
            opacity: 0.7;
        }
        
        .reminder-item.failed {
            border-left-color: #ef4444;
        }
        
        .reminder-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .reminder-member {
            font-weight: 600;
            color: #003057;
            font-size: 1.1rem;
        }
        
        .reminder-status {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .reminder-status.pending {
            background: #fef3c7;
            color: #92400e;
        }
        
        .reminder-status.sent {
            background: #d1fae5;
            color: #065f46;
        }
        
        .reminder-status.failed {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .reminder-details {
            color: #666;
            line-height: 1.6;
            margin-bottom: 1rem;
        }
        
        .reminder-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background: #4a90e2;
            color: white;
        }
        
        .btn-primary:hover {
            background: #357abd;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
        }
        
        .btn-success {
            background: #10b981;
            color: white;
        }
        
        .btn-success:hover {
            background: #059669;
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
        }
        
        .btn-danger:hover {
            background: #dc2626;
        }
        
        .actions {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .loading {
            text-align: center;
            padding: 3rem;
            color: #666;
        }
        
        .no-data {
            text-align: center;
            padding: 3rem;
            color: #999;
            font-style: italic;
        }
        
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 1rem 1.5rem;
            margin-bottom: 2rem;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <!-- WVU Masthead Component -->
    <div id="wvu-masthead"></div>

    <!-- WVU Primary Navigation Component -->
    <div id="wvu-navigation"></div>

    <!-- Back to Dashboard Button -->
    <div class="back-to-dashboard" style="max-width: 1200px; margin: 20px auto; padding: 0 20px;">
        <a href="/admin/dashboard.html" style="display: inline-flex; align-items: center; gap: 8px; padding: 10px 20px; background: linear-gradient(135deg, #002855, #1e40af); color: white; text-decoration: none; border-radius: 8px; font-weight: 600; transition: all 0.2s; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
            <span style="font-size: 1.2rem;">‚Üê</span>
            <span>Back to Dashboard</span>
        </a>
    </div>

    <div class="container">
        <div class="page-header">
            <h1>‚è∞ Automated Dues Reminders</h1>
            <p>Schedule and manage automated reminder emails for members with outstanding dues</p>
        </div>
        
        <div class="info-box">
            <strong>üí° How it works:</strong> The system automatically creates reminders for members who haven't paid their dues. 
            Reminders are scheduled at 30, 60, and 90 days after the membership year starts (July 1). 
            You can manually trigger reminders or let the system send them automatically.
        </div>
        
        <!-- Statistics -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Pending Reminders</div>
                <div class="stat-value" id="pendingCount">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Sent This Month</div>
                <div class="stat-value" id="sentCount">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Failed Reminders</div>
                <div class="stat-value" id="failedCount" style="color: #ef4444;">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Members Need Payment</div>
                <div class="stat-value" id="needPaymentCount" style="color: #fbbf24;">0</div>
            </div>
        </div>
        
        <!-- Settings -->
        <div class="settings-panel">
            <h2>‚öôÔ∏è Reminder Settings</h2>
            <div class="setting-group">
                <div class="form-group">
                    <label for="firstReminder">First Reminder (days after July 1)</label>
                    <input type="number" id="firstReminder" value="30" min="1">
                </div>
                <div class="form-group">
                    <label for="secondReminder">Second Reminder (days)</label>
                    <input type="number" id="secondReminder" value="60" min="1">
                </div>
                <div class="form-group">
                    <label for="thirdReminder">Final Reminder (days)</label>
                    <input type="number" id="thirdReminder" value="90" min="1">
                </div>
            </div>
            <button class="btn btn-primary" onclick="saveSettings()">üíæ Save Settings</button>
        </div>
        
        <!-- Actions -->
        <div class="actions">
            <button class="btn btn-success" onclick="generateReminders()">üîÑ Generate New Reminders</button>
            <button class="btn btn-primary" onclick="sendPendingReminders()">üìß Send All Pending</button>
            <a href="dashboard.html" class="btn btn-secondary">‚Üê Back to Dashboard</a>
        </div>
        
        <!-- Reminder List -->
        <div class="reminder-list">
            <h2>üìã Scheduled Reminders</h2>
            <div id="remindersContainer">
                <div class="loading">Loading reminders...</div>
            </div>
        </div>
    </div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="js/firebase-config.js"></script>
    
    <script src="js/dues-reminders.js"></script>
    <!-- WVU Footer Component -->
    <div id="wvu-footer"></div>

    <!-- Load WVU Components -->
    <script src="/includes/component-loader.min.js"></script>
</body>
</html>
