class CVCWVUAASearch{constructor(e={}){this.container=e.container||document.getElementById("search-container"),this.placeholder=e.placeholder||"Search news, events, minutes...",this.minLength=e.minLength||2,this.data={news:[],minutes:[],events:[]},this.init()}async init(){this.container&&(this.render(),await this.loadData(),this.bindEvents())}render(){this.container.innerHTML=`\n      <div class="search-wrapper">\n        <div class="search-input-wrapper">\n          <input \n            type="text" \n            id="search-input" \n            placeholder="${this.placeholder}"\n            autocomplete="off"\n            spellcheck="false"\n          >\n          <button id="search-clear" style="display:none">&times;</button>\n        </div>\n        <div class="search-filters">\n          <label><input type="checkbox" id="filter-news" checked> News</label>\n          <label><input type="checkbox" id="filter-minutes" checked> Minutes</label>\n          <label><input type="checkbox" id="filter-events" checked> Events</label>\n        </div>\n        <div id="search-results" class="search-results" style="display:none">\n          <div class="search-status"></div>\n          <div class="results-list"></div>\n        </div>\n      </div>\n    `}bindEvents(){const e=this.container.querySelector("#search-input"),t=this.container.querySelector("#search-clear"),s=this.container.querySelectorAll(".search-filters input");e.addEventListener("input",e=>this.handleSearch(e.target.value)),e.addEventListener("focus",()=>this.showResults()),t.addEventListener("click",()=>this.clearSearch()),s.forEach(t=>{t.addEventListener("change",()=>this.handleSearch(e.value))}),document.addEventListener("click",e=>{this.container.contains(e.target)||this.hideResults()})}async loadData(){try{const e=await fetch("/news/posts.json",{cache:"no-store"});if(e.ok){const t=await e.json();this.data.news=t.map(e=>({...e,type:"news",searchText:`${e.title} ${e.author||""}`.toLowerCase(),url:`/news/index.html#${e.slug}`}))}const t=await fetch("/assets/minutes/minutes.json",{cache:"no-store"});if(t.ok){const e=await t.json();this.data.minutes=e.map(e=>({...e,type:"minutes",searchText:`${e.title||""} ${e.note||""}`.toLowerCase(),url:e.url||`/assets/minutes/${e.file}`}))}this.data.events=[{title:"Robert Morris Game Watch",date:"2025-08-30",type:"events",searchText:"robert morris game watch football",url:"/events.html#robert-morris"},{title:"Pittsburgh Game Watch",date:"2025-09-13",type:"events",searchText:"pittsburgh game watch football pitt",url:"/events.html#pittsburgh"},{title:"UCF Game Watch",date:"2025-10-18",type:"events",searchText:"ucf game watch football orlando",url:"/events.html#ucf"},{title:"Colorado Game Watch",date:"2025-11-08",type:"events",searchText:"colorado game watch football",url:"/events.html#colorado"}]}catch(e){console.warn("Search: Could not load all data sources",e)}}handleSearch(e){this.container.querySelector("#search-input");const t=this.container.querySelector("#search-clear");if(0===e.length)return t.style.display="none",void this.hideResults();if(t.style.display="block",e.length<this.minLength)return this.showResults(),this.updateStatus(`Type ${this.minLength-e.length} more character${this.minLength-e.length===1?"":"s"}...`),void this.updateResults([]);const s=this.search(e);this.showResults(),this.updateStatus(`${s.length} result${1===s.length?"":"s"} for "${e}"`),this.updateResults(s)}search(e){const t=e.toLowerCase(),s=this.getActiveFilters();let n=[];return["news","minutes","events"].forEach(e=>{if(!s.includes(e))return;const a=this.data[e].filter(e=>e.searchText.includes(t)||e.title&&e.title.toLowerCase().includes(t));n=n.concat(a)}),n.sort((e,s)=>{const n=e.title?.toLowerCase().includes(t)?0:1,a=s.title?.toLowerCase().includes(t)?0:1;return n!==a?n-a:(s.date||"").localeCompare(e.date||"")}),n.slice(0,20)}getActiveFilters(){const e=this.container.querySelectorAll(".search-filters input:checked");return Array.from(e).map(e=>e.id.replace("filter-",""))}showResults(){this.container.querySelector("#search-results").style.display="block"}hideResults(){this.container.querySelector("#search-results").style.display="none"}updateStatus(e){this.container.querySelector(".search-status").textContent=e}updateResults(e){const t=this.container.querySelector(".results-list");0!==e.length?t.innerHTML=e.map(e=>`\n      <div class="search-result" data-type="${e.type}">\n        <div class="result-header">\n          <a href="${e.url}" class="result-title">${this.highlightQuery(e.title||"Untitled")}</a>\n          <span class="result-type">${this.getTypeLabel(e.type)}</span>\n        </div>\n        <div class="result-meta">\n          ${e.date?this.formatDate(e.date):""}\n          ${e.author?` • ${e.author}`:""}\n          ${e.note?` • ${e.note}`:""}\n        </div>\n      </div>\n    `).join(""):t.innerHTML='<div class="no-results">No results found</div>'}highlightQuery(e){const t=this.container.querySelector("#search-input").value;if(!t||t.length<this.minLength)return e;const s=new RegExp(`(${t})`,"gi");return e.replace(s,"<mark>$1</mark>")}getTypeLabel(e){return{news:"News",minutes:"Minutes",events:"Event"}[e]||e}formatDate(e){try{const t=new Date(e);return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(t)}catch{return e}}clearSearch(){const e=this.container.querySelector("#search-input"),t=this.container.querySelector("#search-clear");e.value="",t.style.display="none",this.hideResults(),e.focus()}}document.addEventListener("DOMContentLoaded",()=>{document.getElementById("search-container")&&new CVCWVUAASearch});