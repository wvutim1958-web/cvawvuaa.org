!function(){let e=[],t=0;function n(e,t={},n=""){const o=document.createElement(e);return Object.entries(t).forEach(([e,t])=>{null!=t&&o.setAttribute(e,t)}),n&&(o.innerHTML=n),o}function o(e){if(e.year)return String(e.year);if(e.date&&/\d{4}/.test(e.date))return e.date.slice(0,4);if((e.src||"").includes("/gallery/archive/"))return"Archive";const t=(e.src||"").match(/\/gallery\/(\d{4})\//);return t?t[1]:"Unknown"}function i(){const n=document.getElementById("lightbox-counter");n&&e.length>0&&(n.textContent=`${t+1} / ${e.length}`)}function r(){if(0===e.length)return;t=(t-1+e.length)%e.length;document.getElementById("lightbox-img").src=e[t],i()}function s(){if(0===e.length)return;t=(t+1)%e.length;document.getElementById("lightbox-img").src=e[t],i()}function l(o,l){e=l||[o],t=e.indexOf(o),-1===t&&(t=0);const d=document.getElementById("lightbox")||function(){const e=n("div");e.id="lightbox",e.style.cssText="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);z-index:9999;align-items:center;justify-content:center;";const t=n("img");t.id="lightbox-img",t.style.cssText="max-width:80%;max-height:90vh;object-fit:contain;border-radius:8px;",t.addEventListener("click",e=>e.stopPropagation());const o=n("div",{},"×");o.style.cssText="position:absolute;top:20px;right:40px;color:white;font-size:60px;font-weight:bold;cursor:pointer;user-select:none;z-index:10001;",o.title="Close (Esc)";const i=n("div",{},"‹");i.id="lightbox-prev",i.style.cssText="position:absolute;left:20px;top:50%;transform:translateY(-50%);color:white;font-size:80px;font-weight:bold;cursor:pointer;user-select:none;padding:20px;z-index:10001;transition:opacity 0.2s;",i.title="Previous (←)";const l=n("div",{},"›");l.id="lightbox-next",l.style.cssText="position:absolute;right:20px;top:50%;transform:translateY(-50%);color:white;font-size:80px;font-weight:bold;cursor:pointer;user-select:none;padding:20px;z-index:10001;transition:opacity 0.2s;",l.title="Next (→)";const d=n("div");return d.id="lightbox-counter",d.style.cssText="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);color:white;font-size:18px;background:rgba(0,0,0,0.5);padding:10px 20px;border-radius:20px;",e.appendChild(t),e.appendChild(o),e.appendChild(i),e.appendChild(l),e.appendChild(d),document.body.appendChild(e),e.addEventListener("click",t=>{t.target===e&&a()}),o.addEventListener("click",e=>{e.stopPropagation(),a()}),i.addEventListener("click",e=>{e.stopPropagation(),r()}),l.addEventListener("click",e=>{e.stopPropagation(),s()}),i.addEventListener("mouseenter",()=>i.style.opacity="0.7"),i.addEventListener("mouseleave",()=>i.style.opacity="1"),l.addEventListener("mouseenter",()=>l.style.opacity="0.7"),l.addEventListener("mouseleave",()=>l.style.opacity="1"),document.addEventListener("keydown",t=>{"flex"===e.style.display&&("Escape"===t.key&&a(),"ArrowLeft"===t.key&&r(),"ArrowRight"===t.key&&s())}),e}();document.getElementById("lightbox-img").src=e[t],d.style.display="flex",document.body.style.overflow="hidden",i();const c=document.getElementById("lightbox-prev"),p=document.getElementById("lightbox-next");if(c&&p){const t=e.length<=1;c.style.display=t?"none":"block",p.style.display=t?"none":"block"}}function a(){const e=document.getElementById("lightbox");e&&(e.style.display="none",document.body.style.overflow="")}document.addEventListener("DOMContentLoaded",async function(){const e=document.getElementById("gallery-grid");if(!e)return;e.innerHTML="";const t=new URLSearchParams(location.search).get("year");let i=await async function(){const e=["content/gallery.json","/content/gallery.json"];for(const t of e)try{const e=await fetch(t,{cache:"no-store"});if(e.ok)return e.json()}catch{}return[]}();Array.isArray(i)||(i=[]);const r=Array.from(new Set(i.map(o))).filter(e=>e&&"Unknown"!==e).sort((e,t)=>t.localeCompare(e));!function(e,t){const o=document.getElementById("gallery-filter");if(!o)return;o.innerHTML="";const i=n("select",{id:"year-select",style:"padding:.5rem;border:1px solid var(--border-color);border-radius:6px"});i.appendChild(n("option",{value:""},"All years")),e.forEach(e=>i.appendChild(n("option",{value:String(e),selected:String(e)===String(t)?"":null},String(e)))),i.addEventListener("change",()=>{const e=i.value,t=new URL(location.href);e?t.searchParams.set("year",e):t.searchParams.delete("year"),location.href=t.toString()}),o.appendChild(i)}(r,t);const s=document.getElementById("year-links");s&&(s.innerHTML="",r.forEach(e=>{const t=n("a",{href:`?year=${e}`,class:"small",style:"margin-right:8px"},e);s.appendChild(t)}));const a=t?i.filter(e=>o(e)===t):i,d=a.filter(e=>"video"!==e.type).map(e=>e.src);a.forEach(t=>e.appendChild(function(e,t){const o=n("figure");if(o.className="card",o.style.padding="8px","video"===e.type){const t=n("video",{controls:"",playsinline:"",preload:"metadata",style:"width:100%;max-height:400px;object-fit:contain;border-radius:8px;background:#f5f5f5"});e.poster&&t.setAttribute("poster",e.poster);const i=n("source",{src:e.src,type:"video/mp4"});t.appendChild(i),o.appendChild(t)}else{const i=n("a");i.href="#",i.style.cssText="cursor:pointer;display:block;",i.addEventListener("click",n=>{n.preventDefault(),l(e.src,t)});const r=n("img",{src:e.src,alt:e.alt||""});r.style.cssText="width:100%;height:auto;border-radius:8px;display:block;transition:opacity 0.2s;",r.title="Click to enlarge",i.addEventListener("mouseenter",()=>r.style.opacity="0.85"),i.addEventListener("mouseleave",()=>r.style.opacity="1"),i.appendChild(r),o.appendChild(i)}const i=n("figcaption");return i.style.marginTop=".5rem",i.innerHTML=`\n      <div><strong>${e.caption||""}</strong></div>\n      <div class="small" style="color:#5b6777">${[e.credit||"",e.date||""].filter(Boolean).join(" • ")}</div>\n    `,o.appendChild(i),o}(t,d))),a.length||e.appendChild(n("div",{class:"small",style:"color:#8a5300"},"No items for the selected year."))})}();